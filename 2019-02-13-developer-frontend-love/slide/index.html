<html>
    <head>
        <link
            rel="stylesheet"
            href="../asset/vendor/reveal.js-3.7.0/css/reveal.css"
        />
        <link rel="stylesheet" href="../asset/vendor/prism-1.15.0/prism.css" />
        <link rel="stylesheet" href="../asset/peerigon/theme-peerigon.css" />
    </head>
    <body id="peerigon">
        <div class="reveal">
            <div class="slides">
                <section
                    id="first-slide"
                    data-background-image="../asset/amsterdam.jpg"
                    data-background-color="black"
                    data-background-opacity="0.5"
                >
                    <style>
                        #first-slide h1 {
                            color: white;
                        }

                        #first-slide .credit {
                            font-size: 1rem;
                            position: fixed;
                            bottom: 10px;
                            opacity: 0.5;
                        }
                    </style>
                    <div class="kicker">Developer Frontend Love</div>
                    <h1>The future of JavaScript bundlers.</h1>
                    <span class="credit">
                        Photo by azhrjl on Unsplash
                    </span>
                </section>
                <section>
                    <section data-background-color="var(--color-whiskey-bg)">
                        <h2>About me</h2>
                    </section>
                    <section>
                        <div style="text-align: center">
                            <img
                                src="../asset/me/me.svg"
                                style="width: 100%;"
                                alt="Image of Johannes Ewald"
                            />
                        </div>
                    </section>
                    <section>
                        <div style="text-align: center">
                            <img
                                src="../asset/peerigon/peerigon-logo-flat-whiskey.svg"
                                width="600"
                                alt="Peerigon logo"
                            />
                        </div>
                    </section>
                    <section>
                        <div style="text-align: center">
                            <img
                                src="../asset/me/webpack-logo.svg"
                                width="700"
                                alt="Webpack logo"
                            />
                        </div>
                    </section>
                </section>
                <section>
                    <section data-background-color="var(--color-whiskey-bg)">
                        <h2>Do we even need JavaScript bundlers?</h2>
                        <!-- TODO: Idea: Amsterdam image -->
                    </section>
                    <section>
                        <div class="kicker">
                            Problems with JavaScript bundlers
                        </div>
                        <h3>There is a build step.</h3>
                        <ul>
                            <li class="fragment">Might be slow</li>
                            <li class="fragment">Adds additional complexity</li>
                        </ul>
                    </section>
                    <section>
                        <div class="kicker">
                            Problems with JavaScript bundlers
                        </div>
                        <h3>You have to configure it.</h3>
                        <ul>
                            <li class="fragment">
                                For special dialects like JSX or CSS modules
                            </li>
                            <li class="fragment">#0CJS is a good start...</li>
                            <li class="fragment">
                                ...but every reasonable-sized app will
                                eventually require custom configuration
                            </li>
                        </ul>
                    </section>
                    <section>
                        <div class="kicker">
                            Problems with JavaScript bundlers
                        </div>
                        <h3>Additional indirection.</h3>
                        <ul>
                            <li class="fragment">
                                The code you write is not the code that is
                                executed
                            </li>
                            <li class="fragment">
                                Configuring source maps can be error prone
                            </li>
                            <li class="fragment">
                                Source maps are slow to generate
                            </li>
                        </ul>
                    </section>
                    <section>
                        <p>
                            You suddenly have to deal with problems you didn't
                            have before.
                        </p>
                    </section>
                    <section>
                        <h3>Native ES modules support in browsers</h3>
                        <p>
                            <!-- TODO: Add caniuse -->
                        </p>
                    </section>
                    <section>
                        <p>
                            Why isn't everyone just using ES modules?
                        </p>
                    </section>
                    <section>
                        <div style="text-align: center">
                            <img
                                src="../asset/bare-specifier-error.jpg"
                                alt="Image of a resolve module error"
                                width="900"
                            />
                        </div>
                    </section>
                    <section>
                        <h3>No bare module specifiers.</h3>
                        <pre data-src="../example/bareModuleSpecifier.js"></pre>
                    </section>
                    <section>
                        <h3>No optional extensions.</h3>
                        <pre data-src="../example/optionalExtension.js"></pre>
                    </section>
                    <section>
                        <h3>No <code>package.json</code> resolving.</h3>
                        <pre
                            data-src="../example/packageJsonResolving.json"
                        ></pre>
                    </section>
                    <section>
                        <p>
                            Since URL lookups are expensive, the browser can't just try out a bunch of possibilities like Node.js does.
                        </p>
                    </section>
                    <section>
                        <p>
                            Will we still need JavaScript bundlers in the future?
                        </p>
                    </section>
                </section>
                <section>
                    <section data-background-color="var(--color-whiskey-bg)">
                        <h2>The purpose of JavaScript bundlers.</h2>
                    </section>
                    <section id="feature-table-1">
                        <style>
                            #feature-table-1 tbody {
                                visibility: hidden;
                            }
                        </style>
                        <feature-table></feature-table>
                    </section>
                    <section>
                        <div class="kicker">Dev experience</div>
                        <h3>
                            They gave us JavaScript modules in all browsers.
                        </h3>
                        <!-- TODO: Fix headline line-height -->
                        <!--TODO: Hooray emojii? -->
                    </section>
                    <section>
                        <div class="kicker">Dev experience</div>
                        <h3>HTML, CSS and WebAssembly modules.</h3>
                    </section>
                    <section>
                        <div class="kicker">Dev experience</div>
                        <h3>
                            They allow us to use custom languages.
                        </h3>
                        <ul>
                            <li class="fragment">JSX</li>
                            <li class="fragment">Vue Single-File Components</li>
                            <li class="fragment">TypeScript</li>
                        </ul>
                    </section>
                    <section>
                        <div class="kicker">Dev experience</div>
                        <h3>Short feedback loop.</h3>
                        <ul>
                            <li class="fragment">
                                Fast rebuilds in watch mode
                            </li>
                            <li class="fragment">Hot module replacement</li>
                            <!--TODO: Hooray emojii? -->
                        </ul>
                    </section>
                    <section id="feature-table-2">
                        <style>
                            #feature-table-2 tbody tr td:not(:first-child) {
                                visibility: hidden;
                            }
                        </style>
                        <feature-table></feature-table>
                    </section>
                    <section>
                        <div class="kicker">Compatibility</div>
                        <h3>They unify module systems.</h3>
                        <p class="fragment">
                            Like ESM, CJS, even WASM and mabe even still AMD.
                        </p>
                    </section>
                    <section>
                        <p>
                            They take care of...
                        </p>
                        <ul>
                            <li class="fragment">
                                ...wiring all imports and exports together
                            </li>
                            <li class="fragment">
                                ...initializing the module graph
                            </li>
                        </ul>
                        <p class="fragment">
                            You don't need to worry about what module system
                            your dependencies are using.
                        </p>
                    </section>
                    <section>
                        <div class="kicker">Compatibility</div>
                        <h3>They unify the underlying platform.</h3>
                        <p class="fragment">
                            Historically, we tried to simulate a CJS environment
                            with Node.js core modules.
                        </p>
                    </section>
                    <section>
                        <div class="kicker">Compatibility</div>
                        <h3>They compile down new language features.</h3>
                        <p class="fragment">
                            Via build tools like Babel and PostCSS.
                        </p>
                    </section>
                    <section id="feature-table-3">
                        <style>
                            #feature-table-3 tbody tr td:nth-child(3) {
                                visibility: hidden;
                            }
                        </style>
                        <feature-table></feature-table>
                    </section>
                    <section>
                        <div class="kicker">Optimization</div>
                        <h3>They create efficient chunks.</h3>
                        <ul>
                            <li class="fragment">
                                By resolving module ids on build time
                            </li>
                            <li class="fragment">
                                By merging modules that depend on each other
                                into a single file.
                            </li>
                        </ul>
                    </section>
                    <section>
                        <div class="kicker">Optimization</div>
                        <h3>
                            They allow us to do effective long-term caching.
                        </h3>
                        <p class="fragment">
                            By calculating asset hashes and automatically
                            updating all URLs.
                        </p>
                    </section>
                    <section>
                        <div class="kicker">Optimization</div>
                        <h3>They add resource hints for the browser.</h3>
                    </section>
                    <section>
                        <div class="kicker">Optimization</div>
                        <h3>They reduce asset file sizes.</h3>
                        <p class="fragment">
                            By removing...
                        </p>
                        <ul>
                            <li class="fragment">
                                unused code (a.k.a. tree-shaking and dead code
                                elimination)
                            </li>
                            <li class="fragment">
                                redundant characters (minification)
                            </li>
                            <li class="fragment">
                                unnecessary bytes (compression)
                            </li>
                        </ul>
                    </section>
                    <section>
                        <p>
                            <strong>Well...</strong>
                        </p>
                        <p>
                            ...they don't actually do the latter, but they
                            orchestrate other tools which do that.
                        </p>
                    </section>
                    <section id="feature-table-4">
                        <feature-table></feature-table>
                    </section>
                </section>
                <section>
                    <section data-background-color="var(--color-whiskey-bg)">
                        <h2>The future of JavaScript bundlers.</h2>
                    </section>
                    <section>
                        <div class="kicker">Dev experience</div>
                        <h3>
                            JS modules.
                        </h3>
                        <p class="fragment">
                            We don't need JS bundlers for that, it's already possible with ESM.
                        </p>
                        <p class="fragment">
                            <strong>But:</strong> our current problem is resolving.
                        </p>
                    </section>
                    <section>
                        <p>
                            Things we can do: <span class="fragment">not rely on <a href="https://www.youtube.com/watch?v=M3BM9TB-8yA" target="_blank">"cute" (Ryan Dahl)</a> resolving features.</span>
                        </p>
                    </section>
                    <section>
                            <ul>
                                    <li>
                                        Use file extensions
                                    </li>
                                    <li class="fragment">
                                        Avoid <code>index.js</code>
                                    </li>
                                    <li class="fragment">
                                        Avoid nesting <code>node_modules</code> (unless you're NPM)
                                    </li>
                                    <li class="fragment">
                                        Avoid module aliases just for ergonomic reasons
                                    </li>
                                </ul>
                    </section>
                    <section id="real-path" data-background-video="../asset/mind-blown.mp4" data-background-video-loop data-background-opacity="0.3" data-background-color="black">
                        <style>
                            #real-path h3 {
                                color: white;
                            }
                        </style>
                        <strong>
                            Just use the real path.
                        </strong>
                        <small>

                        </small>
                    </section>
                    <section data-background-color="black">
                        <p>
                            <strong>Side note:</strong>
                        </p>
                        <p class="fragment">
                            We should use the <code>.mjs</code> extension for JavaScript modules.
                        </p>
                    </section>
                    <section>
                        <h3>
                            But do we really have to give up bare module specifiers (BMS)?
                        </h3>
                    </section>
                    <section>

                    </section>
                    - Advantage of BMS: shorter imports, indirection at package-level which allows the main/browser switch and independent file layout
- Resolving in the browser can only be solved with a strict standard or an external resolving config ([https://github.com/WICG/import-maps](https://github.com/WICG/import-maps))
- The import maps would probably be generated by the package manager?
                </section>
            </div>
        </div>
        <!-- TODO: Allow check marks as slots? -->
        <template id="feature-table">
            <table>
                <thead>
                    <tr>
                        <th>Dev experience</th>
                        <th>Compatibility</th>
                        <th>Optimization</th>
                    </tr>
                </thead>
                <tbody style="font-size: 2rem">
                    <tr>
                        <td>JS modules</td>
                        <td>Unified module systems</td>
                        <td>Efficient chunks</td>
                    </tr>
                    <tr>
                        <td>HTML, CSS & WASM modules</td>
                        <td>Unified platform</td>
                        <td>Long-term caching</td>
                    </tr>
                    <tr>
                        <td>Custom languages</td>
                        <td>New language features</td>
                        <td>Resource hints</td>
                    </tr>
                    <tr>
                        <td>Short feedback loop</td>
                        <td></td>
                        <td>Smaller file sizes</td>
                    </tr>
                </tbody>
            </table>
        </template>
        <script>
            class FeatureTable extends HTMLElement {
                constructor() {
                    super();
                    const template = document.getElementById("feature-table");

                    this.appendChild(document.importNode(template.content, true));
                }
            }

            window.customElements.define("feature-table", FeatureTable);
        </script>
        <script src="../asset/vendor/prism-1.15.0/prism.js"></script>
        <script src="../asset/vendor/reveal-alt-arrows/alt-arrows.js"></script>
        <script src="../asset/vendor/reveal.js-3.7.0/js/reveal.js"></script>
        <script src="../asset/peerigon/colorScheme.js"></script>
        <script>
            Reveal.initialize({
                history: true,
                keyboard: {
                    39: "next", // Right Arrow
                    37: "prev", // Left Arrow
                },
            });
        </script>
    </body>
</html>
